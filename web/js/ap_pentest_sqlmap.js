/* This Javascript contains all the client side features for SQLMAP Test. */

/**
 * Socket Events
 */

/* Result Events */
socket.on('test_sqlmap_reject', function (err) {
	alert('Error: SQLMAP crashed.\nCause:' + err);
	changePage('panel');
});
socket.on('test_sqlmap_success', function () {
//	alert('SQLMAP test complete!');
	changeView('result_sq');
});

/* Progress Events */
socket.on('sqmp_progress_proxy_begin', function (msg) {
	$('#spinner').removeClass();
	$('#spinner').addClass('spinner-layer').addClass('spinner-red-only');
	$('#progress').children('p').remove();
	$('#progress').append('<p style="margin-left:-50px">Waiting for POST Request...</p>');
});
socket.on('sqmp_progress_proxy_done', function (msg) {
	$('#spinner').removeClass();
	$('#spinner').addClass('spinner-layer').addClass('spinner-orange-only');
	$('#progress').children('p').remove();
	$('#progress').append('<p style="margin-left:-70px">Intercepted Matching POST Request!</p>');
});
socket.on('sqmp_progress_sqlmap_begin', function (msg) {
	$('#spinner').removeClass();
	$('#spinner').addClass('spinner-layer').addClass('spinner-blue-only');
	$('#progress').children('p').remove();
	$('#progress').append('<p style="margin-left:-70px">Performing SQL Injection Attacks...</p>');
});
socket.on('sqmp_progress_sqlmap_done', function (msg) {
	$('#spinner').removeClass();
	$('#spinner').addClass('spinner-layer').addClass('spinner-green-only');
	$('#progress').children('p').remove();
	$('#progress').append('<p style="margin-left:-60px">SQL Injection Attack Finished!</p>');
});

/* Stream Events */
socket.on('sqmp_msg_warning_safe', function (msg) {
	$('#result').append($('<p style="color:green;">' +'Info: '+msg+'</p>'));
});
socket.on('sqmp_msg_warning_real', function (msg) {
	$('#result').append($('<p style="color:red;">'   +'Warn: '+msg+'</p>'));
});
socket.on('sqmp_msg_critical_safe', function () {
	$('#result').append($('<h5 style="color:green;">'+'Result: Everything seems okay. Also try on higher levels of depth and risk.'+'</h5>'));
});
socket.on('sqmp_msg_critical_real', function (msg) {
	$('#result').append($('<h5 style="color:red;">'  +'Result:'+msg+'</h5>'));
});


